language:
    - python
python:
    - 3.6
services:
  - postgresql
before_install:
    - sudo apt-get -qq update
install: 
    - pip install -r website/requirements.txt
before_script:
    - psql -c "CREATE database truteordare;" -U postgres
    - psql -c "CREATE USER truteordare WITH PASSWORD 'truteordare';" -U postgres
    - psql -c "ALTER ROLE truteordare SET client_encoding TO 'utf8';" -U postgres
    - psql -c "ALTER ROLE truteordare SET default_transaction_isolation TO 'read committed';" -U postgres
    - psql -c "ALTER ROLE truteordare SET timezone TO 'UTC';" -U postgres
    - psql -c "GRANT ALL PRIVILEGES ON DATABASE truteordare TO truteordare;" -U postgres
script:
    - cd website/
    - python -m pytest tests/